{% extends "base.html" %}
{% load cache heroicons %}
{% block title %}
    {{ block.super }}| Search | iTunes
{% endblock title %}
{% block content %}
    <header class="justify-between items-center pb-3 mb-3 space-y-3 border-b sm:flex sm:space-y-0">
        <h1 class="flex justify-center items-center text-xl font-bold sm:justify-start md:text-2xl xl:text-3xl">
            Search iTunes
        </h1>
        <nav>
            <ul class="items-center space-y-3 sm:flex sm:justify-end sm:space-y-0 sm:space-x-3">
                <li class="flex justify-center items-center sm:justify-end">
                    <a class="inline-flex items-center btn btn-default"
                       href="{% url "podcasts:search_podcasts" %}{{ request.search.qs }}">
                        {% heroicon_mini "magnifying-glass" class="mr-2" %}
                        Search Podcasts
                    </a>
                </li>
                <li class="flex justify-center items-center sm:justify-end">{% search_form "Search: Podcasts" %}</li>
            </ul>
        </nav>
    </header>
    {% cache cache_timeout search-itunes request.get_full_path %}
    <ul class="divide-y divide-solid">
        {% for feed in feeds %}
            <li class="py-3 first:pt-0 first:pb-3 last:pt-3 last:pb-0">
                {% if feed.podcast and feed.podcast.pub_date %}
                    {% include "podcasts/_podcast.html" with podcast=feed.podcast %}
                {% else %}
                    <article class="flex items-center space-x-3">
                        {% cover_image feed.image 100 feed.title css_class="h-16 w-16" %}
                        <div class="flex flex-col place-content-between h-14">
                            <h2 class="font-bold tracking-tight leading-tight break-words line-clamp-2">
                                <a title="{{ feed.title }}"
                                   aria-label="{{ feed.title }}"
                                   class="font-bold link"
                                   rel="noopener nofollow"
                                   target="_blank"
                                   href="{{ feed.url }}">{{ feed.title }}</a>
                            </h2>
                            <h3 class="w-60 text-xs font-semibold tracking-tight leading-tight text-gray-600 md:w-96 md:text-sm dark:text-gray-300 truncate">
                                <span class="animate-pulse">Adding podcast to database...</span>
                            </h3>
                        </div>
                    </article>
                {% endif %}
            </li>
        {% empty %}
            <li>
                No results found for <span class="font-bold">{{ request.search.value }}</span>.
            </li>
        {% endfor %}
    </ul>
{% endcache %}
{% endblock content %}
