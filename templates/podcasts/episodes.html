{% extends "podcasts/detail_base.html" %}
{% load cache heroicons partials %}
{% block title %}
    {{ block.super }} | Episodes
{% endblock title %}
{% block podcast_navbar %}
    {{ block.super }}
    {% cache CACHE_TIMEOUT podcast-episodes-header request.get_full_path %}
        {% if page_obj.has_other_pages or request.search %}
            <nav class="flex justify-center items-center sm:justify-start">
                <ul class="items-center space-y-3 sm:flex sm:space-y-0 sm:space-x-3">
                    {% if request.search %}
                        <li class="flex justify-center items-center sm:justify-end">
                            {% url "episodes:search_episodes" as search_url %}
                            {% search_button search_url "Search All Episodes" %}
                        </li>
                    {% else %}
                        <li class="flex justify-center items-center mb-3 sm:justify-start sm:mb-0">
                            {% if ordering_asc %}
                                <a href="{{ request.path }}{% querystring order="desc" page=None %}"
                                   class="link">Newest First</a>
                            {% else %}
                                <a href="{{ request.path }}{% querystring order="asc" page=None %}"
                                   class="link">Oldest First</a>
                            {% endif %}
                        </li>
                    {% endif %}
                    <li class="flex justify-center items-center sm:justify-end">{% search_form placeholder="Search: Episodes" %}</li>
                </ul>
            </nav>
        {% endif %}
    {% endcache %}
{% endblock podcast_navbar %}
{% block podcast_content %}
    {% partialdef pagination inline=True %}
        {% cache CACHE_TIMEOUT podcast-episodes request.get_full_path %}
            {% with pagination_target="pagination" has_other_pages=page_obj.has_other_pages %}
                <ul class="divide-y divide-solid" id="{{ pagination_target }}">
                    {% if has_other_pages %}
                        <li class="pb-3">{% include "_pagination_links.html" %}</li>
                    {% endif %}
                    {% for episode in page_obj %}
                        <li class="py-3 first:pt-0 last:pb-0">{% include "podcasts/_episode.html" %}</li>
                    {% empty %}
                        <li class="text-center prose sm:text-start dark:prose-invert">
                            {% if request.search %}
                                No episodes for &quot;<strong>{{ request.search.value }}</strong>&quot; found in this podcast.
                            {% else %}
                                This podcast does not have any episodes.
                            {% endif %}
                        </li>
                    {% endfor %}
                    {% if has_other_pages %}
                        <li class="pt-3">{% include "_pagination_links.html" %}</li>
                    {% endif %}
                </ul>
            {% endwith %}
        {% endcache %}
    {% endpartialdef pagination %}
{% endblock podcast_content %}
