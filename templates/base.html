{% spaceless %}
    {% load static player %}
    {% if not request.htmx %}
        <!DOCTYPE html>
        <html lang="en">

            <head>
    {% endif %}
    <title>
        {{ request.site.name }}{% block title %}{% endblock %}
    </title>
    {% if request.htmx %}
        {% include "_signup_cta.html" with hx_oob=True %}

    {%  else %}
        {% include "_meta.html" %}
        {% include "_static.html" %}
        {% include "_google_search.html" %}
        </head>

        <body class="container-xl mx-auto antialiased font-sans dark:bg-black dark:text-white text-sm lg:text-base"
            hx-boost="true"
            hx-target="#layout"
            hx-swap="outerHTML show:window:top"
            hx-indicator="#loader"
            hx-headers='{"X-CSRFToken": "{{ csrf_token }}"}'>

            {% include "_hx_indicator.html" %}

            <div class="flex flex-col h-screen">
                <div class="flex-grow">
                    {% include "_navbar.html" %}

    {% endif %}

    {% include "_messages.html" with hx_oob=request.htmx %}

    <div hx-history-elt id="layout">
        <div class="flex relative p-2 pt-6 mx-auto xl:w-4/5 h-full">
            <aside class="w-full hidden xl:block xl:w-1/5 xl:sticky xl:h-full xl:top-16">
                {% include "_sidebar.html" %}
            </aside>

            <main class="w-full xl:block lg:w-4/5 lg:mx-auto">
                {% block content %}{% endblock %}
            </main>
        </div>
    </div>

    {% if not request.htmx %}
        </div>

        {% cookie_notice %}

        {% if user.is_authenticated %}
            <div id="player">
                {% audio_player %}
            </div>
            {% include "episodes/_player_js.html" %}
        {% endif %}

        {% include "_footer.html" %}
        </div>

        </body>

        </html>
    {% endif %}
{% endspaceless %}
