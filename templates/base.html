{% load static i18n player %}
{% block header_tags %}
<!DOCTYPE html>
{% get_current_language as language_code %}
<html lang="{{ language_code }}">

<head>
  {% block head %}
  {% block title_tag %}
  <title>
    {% spaceless %}{% block title %}{{ request.site.name }}{% block subtitle %}{% endblock %}{% endblock %}{% endspaceless %}
  </title>
  {% endblock title_tag %}
  {% block meta_tags %}
  {% include "_meta.html" %}
  {% endblock meta_tags %}
  {% include "_static.html" %}
  {% include "_google_search.html" %}
  {% endblock head %}
</head>

<body {% block bodyattrs %}
      class="container-xl mx-auto antialiased font-sans dark:bg-black dark:text-white text-sm"
      hx-boost="true"
      hx-target="#layout"
      hx-ext="intersect"
      hx-swap="outerHTML show:window:top"
      hx-indicator="#loader"
      hx-headers='{"X-CSRFToken": "{{ csrf_token }}"}'
      x-data="{sidebar: false}"
      @close-sidebar.window="sidebar=false"
      @toggle-sidebar.window="sidebar=!sidebar"
      {% endblock %}>
  {% endblock header_tags %}

  {% block page_header %}
  {% block navbar %}{% include "_navbar.html" %}{% endblock %}
  {% block hx_indicator %}{% include "_hx_indicator.html" %}{% endblock %}
  {% endblock page_header %}

  {% block messages %}
  {% include "_messages.html" %}
  {% endblock messages %}
  {% block layout %}

  <div class="min-h-full mx-auto flex relative p-2 pt-6"
       hx-history-elt
       id="layout">

    {% block sidebar %}
    <aside class="w-full hidden lg:block lg:w-1/6 lg:sticky lg:top-24 lg:h-screen pt-3 lg:pt-0"
           :class="{'hidden lg:block': !sidebar}">
      {% include "_sidebar.html" %}
    </aside>
    {% endblock %}

    {% block main %}
    <main class="w-full lg:block lg:w-4/6"
          :class="{'hidden lg:block': sidebar}">

      {% block content %}{% endblock %}

    </main>
    {% endblock main %}
  </div>
  {% endblock layout %}

  {% block cookie_notice %}
  {% cookie_notice %}
  {% endblock %}

  {% block page_footer %}
  {% block player %}
  {% if user.is_authenticated %}
  <div id="player">
    {% audio_player %}
  </div>
  {% endif %}
  {% endblock player %}

  {% endblock page_footer %}
  {% block footer_tags %}
</body>

</html>
{% endblock footer_tags %}
