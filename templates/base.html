{% extends "layout_base.html" %}
{% load static i18n %}
{% block header_tags %}
<!DOCTYPE html>
{% get_current_language as language_code %}
<html lang="{{ language_code }}">

<head>
  {% block head %}
  {% block title_tag %}{{ block.super }}{% endblock title_tag %}
  {% block meta_tags %}
  {% include "_meta.html" %}
  {% endblock meta_tags %}
  {% include "_static.html" %}
  {% endblock head %}
</head>

<body {% block bodyattrs %}
      class="container-lg mx-auto antialiased font-sans dark:bg-black dark:text-white"
      hx-boost="true"
      hx-target="#layout"
      hx-ext="intersect"
      hx-swap="outerHTML"
      hx-indicator="#loader"
      hx-headers='{"X-CSRFToken": "{{ csrf_token }}"}'
      x-data="{sidebar: false}"
      @close-sidebar.window="sidebar=false"
      @toggle-sidebar.window="sidebar=!sidebar"
      {% endblock %}>

  {% endblock header_tags %}
  {% block page_header %}
  {% block navbar %}{% include "_navbar.html" %}{% endblock %}
  {% block cookie_notice %} {% include "_cookie_notice.html" %}{% endblock %}
  {% endblock page_header %}

  <div class="hx-indicator"
       id="loader"
       x-data="{width: 0}"
       x-init="
         setInterval(() => {
           if ($el.classList.contains('htmx-request')) {
             width = width + (Math.random() / 100);
             $el.style.width = `${10 + (width * 90)}%`;
           } else {
             width = 0;
           }
         }, 300);
         "></div>

  {% block layout %}
  {{ block.super }}
  {% endblock layout %}

  {% block page_footer %}

  {% include "_messages.html" %}

  {% block player %}
  {% if user.is_authenticated %}
  {% include "_player.html" %}
  {% endif %}
  {% endblock player %}

  <div id="modal"></div>

  {% endblock page_footer %}
  {% block footer_tags %}
</body>

</html>
{% endblock footer_tags %}
