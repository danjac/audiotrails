{% with podcast=episode.podcast episode_url=episode.get_absolute_url %}
<div class="p-3 space-y-2 border dark:border-gray-500 mb-3"
     {% if hx_remove %}
     x-data="{show: true}"
     x-show="show"
     x-transition:leave="transition ease-out duration-500"
     x-transition:leave-start="transform opacity-100"
     x-transition:leave-end="transform opacity-0"
     @{{ hx_remove }}.window="if ($event.detail.value === {{ episode.id }}) show=false"
     {% endif %}>

  {% block episode_title %}
  <h2 class="flex flex-wrap font-semibold break-words">
    <a href="{{ episode_url }}"
       class="link"
       title="{{ episode.cleaned_title }}">
      {{ episode.cleaned_title|truncatechars:120 }}
    </a>
  </h2>
  {% endblock episode_title %}

  {% block podcast_title %}
  {% if not is_podcast_detail %}
  <h3 class="flex flex-wrap font-semibold break-words">
    <a href="{{ podcast.get_episodes_url }}"
       class="link text-gray-600 dark:text-gray-300 text-xs"
       title="{{ podcast.cleaned_title }}">
      {{ podcast.cleaned_title|truncatechars:120 }}
    </a>
  </h3>
  {% endif %}
  {% endblock podcast_title %}


  {% block content %}
  <div class="flex items-center w-full space-x-3">

    <div>

      {% if is_podcast_detail %}
      <a href="{{ episode_url }}">
        {% include "_cover_image.html" with cover_url=episode.get_cover_url alt=episode.cleaned_title size=16 %}
      </a>
      {% else %}
      <a href="{{ podcast.get_absolute_url }}">
        {% include "_cover_image.html" with cover_url=podcast.cover_url alt=podcast.cleaned_title size=16 %}
      </a>
      {% endif %}
    </div>

    <div class="space-y-3">

      {% if user.is_authenticated %}
      <div class="font-semibold text-gray-600 dark:text-gray-300 text-xs">
        {% include "episodes/_pub_date.html" with pub_date=episode.pub_date %}
        {{ episode.duration_in_seconds|format_duration }}
      </div>
      <div>
        {% include "episodes/_actions_toggle.html" %}
      </div>
      {% else %}
      <div class="font-semibold text-gray-600 dark:text-gray-300 text-xs">
        {% include "episodes/_pub_date.html" with pub_date=episode.pub_date %}
      </div>
      {% if episode.duration_in_seconds %}
      <div class="font-semibold text-gray-600 dark:text-gray-300 text-xs">
        {{ episode.duration_in_seconds|format_duration }}
      </div>
      {% endif %}
      {% endif %}

    </div>
  </div>
  {% endblock content %}
</div>
{% endwith %}
