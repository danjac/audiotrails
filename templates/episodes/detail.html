{% extends "base.html" %}
{% load heroicons %}
{% block title %}
    | {{ episode.podcast.cleaned_title }} | {{ episode.cleaned_title }}
{% endblock title %}
{% block content %}
    {% with podcast=episode.podcast next_episode=episode.get_next_episode previous_episode=episode.get_previous_episode %}
        <header class="pb-3 mb-6 border-b space-y-6">
            <h1 class="text-lg font-bold lg:text-xl xl:text-2xl">{{ episode.cleaned_title }}</h1>
            {% if next_episode or previous_episode %}
                <nav>
                    <ul class="flex justify-between"
                        role="navigation"
                        aria-label="Pagination">
                        <li>
                            {% if previous_episode %}
                                <a class="link"
                                   href="{{ previous_episode.get_absolute_url }}"
                                   aria-label="{{ previous_episode.cleaned_title }}"
                                   title="{{ previous_episode.cleaned_title }}">Previous</a>
                            {% else %}
                                <span class="text-gray-600 cursor-not-allowed dark:text-gray-300"
                                      title="No More Episodes"
                                      aria-label="No More Episodes">Previous</span>
                            {% endif %}
                        </li>
                        <li>
                            {% if next_episode %}
                                <a class="link"
                                   href="{{ next_episode.get_absolute_url }}"
                                   aria-label="{{ next_episode.cleaned_title }}"
                                   title="{{ next_episode.cleaned_title }}">Next</a>
                            {% else %}
                                <span class="text-gray-600 cursor-not-allowed dark:text-gray-300"
                                      title="No More Episodes"
                                      aria-label="No More Episodes">Next</span>
                            {% endif %}
                        </li>
                    </ul>
                </nav>
            {% endif %}
        </header>
        <article class="space-y-3">
            <h2 class="text-base lg:text-lg">
                <a href="{{ podcast.get_episodes_url }}"
                   title="See all episodes for {{ podcast.cleaned_title }}"
                   class="link">{{ podcast.cleaned_title }}</a>
            </h2>
            {% with metadata=episode.get_episode_metadata %}
                {% if metadata %}
                    <div class="flex items-center font-semibold text-gray-800 space-x-3 dark:text-gray-300">{{ metadata }}</div>
                {% endif %}
            {% endwith %}
            <div class="flex items-center space-x-3 sm:space-x-6">
                {% cover_image episode.get_cover_url 200 podcast.cleaned_title url=podcast.get_absolute_url css_class="h-32 w-32 lg:h-40 lg:w-40" %}
                <div class="flex flex-col place-content-between h-28 lg:h-32">
                    {% include "episodes/_player_toggle.html" %}
                    {% include "episodes/_bookmark_toggle.html" %}
                    <div class="flex flex-wrap items-center font-semibold text-gray-800 dark:text-gray-300 space-x-2 sm:space-x-3">
                        <a download
                           title="Download audio file to your device"
                           href="{{ episode.media_url }}"
                           class="link">Download</a>
                        {% with link=episode.get_link|force_url %}
                            {% if link %}
                                <a href="{{ link }}"
                                   target="_blank"
                                   rel="noopener"
                                   class="link"
                                   title="Link to Website">Website</a>
                            {% endif %}
                        {% endwith %}
                    </div>
                </div>
            </div>
            <div class="flex items-center font-semibold text-gray-600 dark:text-gray-300 space-x-3">
                {% include "_date.html" with value=episode.pub_date title="Release Date" %}
                {% with file_size=episode.get_file_size %}
                    {% if file_size %}<div title="Size">{{ file_size }}</div>{% endif %}
                {% endwith %}
                {% with duration=episode.duration_in_seconds %}
                    {% if duration %}<span title="Duration">{{ duration|format_duration }}</span>{% endif %}
                {% endwith %}
                {% with explicit=episode.is_explicit %}
                    {% if explicit %}
                        <div title="May contain adult themes and language. Listener discretion advised."
                             class="flex items-center text-red-600 dark:text-red-500 space-x-2">
                            {% heroicon_outline "exclamation-triangle" size=20 %} <span class="inline-block">Explicit</span>
                        </div>
                    {% endif %}
                {% endwith %}
            </div>
            {% include "episodes/_audio_log.html" %}
            {% markdown episode.description %}
        </article>
    {% endwith %}
{% endblock content %}
