{% extends "account/settings_base.html" %}
{% load i18n %}

{% block title %}{{ block.super }} | {% translate "E-mail Addresses" %}{% endblock %}

{% block settings_content %}
    {% with emailaddresses=user.emailaddress_set.all num_addresses=user.emailaddress_set.count %}
        {% if num_addresses %}
            <p class="mb-3">{% translate "The following e-mail addresses are associated with your account:" %}</p>

            <form class="space-y-3 mb-3"
                hx-disable="true"
                method="post"
                id="email-addresses"
                action="{% url 'account_email' %}">
                {% csrf_token %}
                {% for emailaddress in emailaddresses %}
                    <div>
                        <label for="email_radio_{{ forloop.counter }}"
                            class="flex items-center">

                            <input id="email_radio_{{ forloop.counter }}"
                                type="radio"
                                name="email"
                                class="mr-3"
                                {% if emailaddress.primary or num_addresses == 1 %}checked="checked"
                                {% endif %}
                                value="{{ emailaddress.email }}" />

                            <div{% if emailaddress.primary or num_addresses == 1 %} class="font-bold"{% endif %}>
                                <div class="flex items-center">
                                    {{ emailaddress.email }}
                                    {% if emailaddress.verified %}
                                        <i class="fa fa-check ml-2 text-green-500" aria-hidden="true"></i>
                                    {% endif %}
                                </div>
                            </div>

                        </label>
                    </div>
                {% endfor %}
                <div class="flex items-center space-x-2 md:space-x-3">
                    <button class="inline-flex items-center btn btn-secondary"
                        name="action_send"
                        value="1">
                        <i class="fa fa-envelope mr-2" aria-hidden="true"></i>
                        {% translate "Re-Verify" %}
                    </button>


                    {% if num_addresses > 1 %}
                        <button class="inline-flex items-center btn btn-default"
                            name="action_primary"
                            value="1">
                            <i class="fa fa-hand-point-up mr-2" aria-hidden="true"></i>
                            {% translate "Primary" %}
                        </button>
                        <button class="inline-flex items-center btn btn-danger"
                            name="action_remove"
                            value="1">
                            <i class="fa fa-trash mr-2" aria-hidden="true"></i>
                            {% translate "Remove" %}
                        </button>
                    {% endif %}
                </div>
            </form>


        {% else %}

            <p class="border-b dark:border-gray-500 pb-3 mb-3"><strong>{% translate "Warning:" %}</strong>
                {% blocktranslate %}
                    You currently do not have any e-mail address set up. You should really add an e-mail address so you can receive notifications, reset your password, etc.
                {% endblocktranslate %}
            </p>

        {% endif %}

    {% endwith %}
    {% if can_add_email %}
        <h2 class="font-semibold mb-3 mt-6">{% translate "Add New E-mail Address" %}</h2>
        <form method="post"
            action="{{ request.path }}"
            class="space-y-3"
            hx-disable="true"
            novalidate>
            {% csrf_token %}
            {{ form }}
            <div class="flex items-center">
                <button class="inline-flex items-center btn btn-default"
                    name="action_add"
                    value="true">
                    <i class="fa fa-plus mr-2" aria-hidden="true"></i>
                    {% translate "Add E-Mail" %}
                </button>
            </div>
        </form>
    {% endif %}
{% endblock %}
