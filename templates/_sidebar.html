{% load cache %}
<div class="flex justify-center sm:hidden mb-3">

  <form hx-get="{% url 'podcasts:search_podcasts' %}"
        x-data="{}"
        class="relative bg-transparent"
        @submit="sidebar=false; $refs.input.blur();">
    <input type="search"
           x-ref="input"
           name="q"
           autocomplete="off"
           aria-label="{{ placeholder|default:'Search' }}"
           placeholder="Find a podcast..."
           class="px-4 py-1 focus:outline-none focus:ring rounded w-64 placeholder-opacity-100 text-gray-900 dark:bg-gray-900 dark:text-white">
    <div class="absolute inset-y-0 right-0 flex items-center pr-3">
      <button type="submit"
              title="Search"
              class="focus:outline-none focus:shadow-outline text-gray-900 dark:text-gray-100">
        {% icon "search" css_class="h-4 w-4" %}
      </button>
    </div>
  </form>
</div>

<nav class="mt-1"
     x-data="{active: '{% if request.resolver_match.app_name %}{{ request.resolver_match.app_name }}:{% endif %}{{ request.resolver_match.url_name }}'}">
  <ul class="sidebar">
    <li class="py-2">
      <a {% hx_link 'episodes:index' %}
         accesskey="1"
         title="New Releases"
         @click="sidebar=false; active='episodes:index'"
         :class="{'sidebar--active': active === 'episodes:index'}"
         class="flex items-center link">
        {% icon "lightning_bolt" css_class="h-5 w-5 mr-3" %}
        New Releases
      </a>
    </li>
    <li class="py-2">
      <a {% hx_link 'podcasts:index' %}
         accesskey="2"
         title="Podcasts"
         @click="sidebar=false; active='podcasts:index'"
         :class="{'sidebar--active': active === 'podcasts:index'}"
         class="flex items-center link">
        {% icon "rss" css_class="h-5 w-5 mr-3" %}
        Podcasts
      </a>
    </li>
    <li class="py-2">
      <a {% hx_link 'podcasts:categories' %}
         accesskey="3"
         title="Discover"
         @click="sidebar=false; active='podcasts:categories'"
         :class="{'sidebar--active': active === 'podcasts:categories'}"
         class="flex items-center link">
        {% icon "search" css_class="h-5 w-5 mr-3" %}
        Discover
      </a>
    </li>
    {% if user.is_authenticated %}
    <li class="py-2">
      <a {% hx_link 'episodes:queue' %}
         accesskey="4"
         title="Play Queue"
         @click="sidebar=false; active='episodes:queue'"
         :class="{'sidebar--active': active === 'episodes:queue'}"
         class="flex items-center link">
        {% icon "collection" css_class="h-5 w-5 mr-3" %}
        Play Queue
      </a>
    </li>


    <li class="py-2">
      {% active_link 'episodes:favorites' as link %}
      <a {{ link.hx }}
         accesskey="5"
         title="Favorites"
         @click="sidebar=false; active='episodes:favorites'"
         :class="{'sidebar--active': active === 'episodes:favorites'}"
         class="flex items-center link">
        {% icon "star" css_class="h-5 w-5 mr-3" %}
        Favorites
      </a>
    </li>

    <li class="py-2">
      <a {% hx_link 'episodes:history' %}
         accesskey="6"
         title="History"
         @click="sidebar=false; active='episodes:history'"
         :class="{'sidebar--active': active === 'episodes:history'}"
         class="flex items-center link">
        {% icon "database" css_class="h-5 w-5 mr-3" %}
        History
      </a>
    </li>

    <li class="py-2">
      <a {% hx_link 'user_preferences' %}
         accesskey="7"
         title="Settings"
         @click="sidebar=false; active='user_preferences'"
         :class="{'sidebar--active': active === 'user_preferences'}"
         class="flex items-center link">
        {% icon "adjustments" css_class="h-5 w-5 mr-3" %}
        Settings
      </a>
    </li>
    {% endif %}

    <li class="py-2">
      <a {% hx_link 'about:credits' %}
         accesskey="8"
         title="About"
         @click="sidebar=false; active='about'"
         :class="{'sidebar--active': active === 'about'}"
         class="flex items-center link">
        {% icon "info" css_class="h-5 w-5 mr-3" %}
        About
      </a>
    </li>

  </ul>
</nav>
