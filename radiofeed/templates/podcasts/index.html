{% extends "base.html" %}
{% load cache i18n %}

{% block title %} | {% translate "Podcasts" %}{% if has_subscriptions %} | {% if promoted %} {% translate "Promotions" %}{% else %}{% translate "Subscriptions" %}{% endif %}{% endif %}{% endblock %}

{% block content %}

    {% translate "Podcasts" as t_podcasts %}
    {% translate "Promotions" as t_promotions %}
    {% translate "Subscriptions" as t_subscriptions %}

    <header class="mb-3 pb-3 border-b dark:border-gray-500 space-y-3">

        {% if has_subscriptions %}

            {% url 'podcasts:index' as index_url %}

            <div class="sm:flex justify-between">
                <h1 class="font-bold text-lg md:text-xl xl:text-2xl text-center sm:text-left mb-3 sm:mb-0">
                    {{ t_podcasts }}: {% if promoted %}{{ t_promotions }}{% else %}{{ t_subscriptions }}{% endif %}
                </h1>
                <div class="flex items-center justify-center sm:justify-start">
                    {% if promoted %}
                        <a href="{{ index_url }}"
                            class="link">
                            {{ t_subscriptions }}
                        </a>
                    {% else %}
                        <a href="{{ index_url }}?promoted=true"
                            class="link">
                            {{ t_promotions }}
                        </a>
                    {% endif %}
                </div>
            </div>
        {% else %}
            {% if request.user.is_anonymous %}
                {% with site_name=request.site.name %}
                    <h1 class="font-bold text-lg md:text-xl xl:text-2xl text-center sm:text-left">
                        Welcome to {{ site_name }}!
                    </h1>
                    <h2 class="font-semibold text-base md:text-lg xl:text-xl text-center sm:text-left">
                        {% blocktranslate %}
                            <strong>{{ site_name }}</strong> is a <strong>free</strong> web app for discovering and listening to your favorite podcast feeds.
                        {% endblocktranslate %}
                    </h2>
                {% endwith %}
            {% else %}
                <h1 class="font-bold text-lg md:text-xl xl:text-2xl text-center sm:text-left">
                    {{ t_podcasts }}
                </h1>
            {% endif %}
        {% endif %}
    </header>
    {% if request.user.is_authenticated %}
        <div role="list" class="dark:divide-gray-500 divide-y divide-solid">
            {% include "includes/pagination_links.html" %}
            {% for podcast in page_obj.object_list %}
                {% include "podcasts/includes/podcast.html" %}
            {% empty %}
                {% include "includes/empty.html" %}
            {% endfor %}
            {% include "includes/pagination_links.html" %}
        </div>
    {% else %}
        <div role="list" class="grid grid-cols-3 sm:grid-cols-4 lg:grid-cols-6 gap-2 md:gap-3">
            {% cache 600 podcasts-promoted-anonymous %}
                {% for podcast in page_obj %}
                    {% with css_class="h-28 w-28 sm:h-40 sm:w-40" %}
                        <div class="{{ css_class }}">
                            {% include "includes/cover_image.html" with cover_url=podcast.cover_url alt=podcast.cleaned_title url=podcast.get_absolute_url %}
                        </div>
                    {% endwith %}
                {% endfor %}
            {% endcache %}
        </div>
    {% endif %}

{% endblock content %}
