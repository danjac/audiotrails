name: deploy:dokku

on:
    workflow_dispatch:
        workflows: ["runtests"]
        branches: [main]
        types:
            - completed

jobs:
    deploy:
        runs-on: ubuntu-latest
        steps:
            - uses: actions/checkout@v2
              with:
                  fetch-depth: 0

            - name: Deploy to dokku
              uses: vitalyliber/dokku-github-action@v7.0
              env:
                  PRIVATE_KEY: ${{ secrets.DOKKU_SSH_PRIVATE_KEY }}
                  HOST: ${{ secrets.DOKKU_HOST }}
                  PROJECT: ${{ secrets.DOKKU_APP }}
                  BRANCH: main
